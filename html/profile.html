<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Homepage</title>
    <meta name="comp1800 boilerplate code" content="my bcit project"/>
    <meta name="author" content="BCIT"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/>
    
    <!-- Bootstrap, firebase-auth-ui -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-BmbxuPwQa2lc/FVzBcNJ7UAyJxM6wuqIj61tLrc4wSX0szH/Ev+nYRRuWlolflfl" crossorigin="anonymous">
        <link type="text/css" rel="stylesheet" href="https://www.gstatic.com/firebasejs/ui/4.8.1/firebase-ui-auth.css" />

    <!-- Firebase 8 CDNs-->
    <!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script> -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
     <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
     <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
     <script src="https://www.gstatic.com/firebasejs/ui/4.8.1/firebase-ui-auth.js"></script>
    

     <!-- Link to the api keys for your firebase project -->
    <script src="../scripts/firebaseAPI.js"></script>

    <!-- Optional styles -->
    <link type="text/css" href="styles/my_style.css">
    <!-- <link type="text/css" href="../styles/my_style.css"> -->
    <style>
        body {
            display: grid;
            grid-template-columns: 50% 50%;
            grid-template-rows: 50vh 50vh;
        }

        #profileIcon {
            grid-column: 1 / span 2;
            grid-row: 1 / span 1;
        }

        #pref {
            text-align: center;
            grid-column: 2 / span 1;
            grid-row: 2 / span 1;
        }

        #friend {
            display: grid;
            grid-template-columns: 100%;
            grid-template-rows: 10% 30% 30% 30%;
            text-align: left;
            grid-column: 1 / span 1;
            grid-row: 2 / span 1;
        }

        #fT {
            grid-column: 1 / span 1;
            grid-row: 1 / span 1;
        }

        #f1 {
            text-align: left;
            grid-column: 1 / span 1;
            grid-row: 2 / span 1;
        }

        #f2 {
            text-align: left;
            grid-column: 1 / span 1;
            grid-row: 3 / span 1;
        }

        #f3 {
            text-align: left;
            grid-column: 1 / span 1;
            grid-row: 4 / span 1;
        }

        #progress {
            text-align: center;
        }
    </style>
</head>

<body>
    <nav class="nav-fill navbar-collapse navbar-expand-lg navbar-light bg-info fixed-bottom">
        <div class="container-fluid">
            <div class="navbar-expand" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" href="main.html">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor"
                                class="bi bi-house-door-fill">
                                <path
                                    d="M6.5 14.5v-3.505c0-.245.25-.495.5-.495h2c.25 0 .5.25.5.5v3.5a.5.5 0 0 0 .5.5h4a.5.5 0 0 0 .5-.5v-7a.5.5 0 0 0-.146-.354L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.354 1.146a.5.5 0 0 0-.708 0l-6 6A.5.5 0 0 0 1.5 7.5v7a.5.5 0 0 0 .5.5h4a.5.5 0 0 0 .5-.5z" />
                            </svg>
                            <small class="text-center d-block">Home</small>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="profile.html">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor"
                                class="bi bi-person-fill">
                                <path d="M3 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1H3zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6z" />
                            </svg>
                            <small class="text-center d-block">Profile</small>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="settings.html">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor"
                                class="bi bi-gear-fill">
                                <path
                                    d="M9.405 1.05c-.413-1.4-2.397-1.4-2.81 0l-.1.34a1.464 1.464 0 0 1-2.105.872l-.31-.17c-1.283-.698-2.686.705-1.987 1.987l.169.311c.446.82.023 1.841-.872 2.105l-.34.1c-1.4.413-1.4 2.397 0 2.81l.34.1a1.464 1.464 0 0 1 .872 2.105l-.17.31c-.698 1.283.705 2.686 1.987 1.987l.311-.169a1.464 1.464 0 0 1 2.105.872l.1.34c.413 1.4 2.397 1.4 2.81 0l.1-.34a1.464 1.464 0 0 1 2.105-.872l.31.17c1.283.698 2.686-.705 1.987-1.987l-.169-.311a1.464 1.464 0 0 1 .872-2.105l.34-.1c1.4-.413 1.4-2.397 0-2.81l-.34-.1a1.464 1.464 0 0 1-.872-2.105l.17-.31c.698-1.283-.705-2.686-1.987-1.987l-.311.169a1.464 1.464 0 0 1-2.105-.872l-.1-.34zM8 10.93a2.929 2.929 0 1 1 0-5.86 2.929 2.929 0 0 1 0 5.858z" />
                            </svg>
                            <small class="text-center d-block">Settings</small>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="avatar-container pt-5" id="profileIcon">
        <button class="btn btn-secondary" id="backButton">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-backspace"
                viewbox="0 0 16 16">
                <path
                    d="M5.83 5.146a.5.5 0 0 0 0 .708L7.975 8l-2.147 2.146a.5.5 0 0 0 .707.708l2.147-2.147 2.146 2.147a.5.5 0 0 0 .707-.708L9.39 8l2.146-2.146a.5.5 0 0 0-.707-.708L8.683 7.293 6.536 5.146a.5.5 0 0 0-.707 0z" />
                <path
                    d="M13.683 1a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-7.08a2 2 0 0 1-1.519-.698L.241 8.65a1 1 0 0 1 0-1.302L5.084 1.7A2 2 0 0 1 6.603 1h7.08zm-7.08 1a1 1 0 0 0-.76.35L1 8l4.844 5.65a1 1 0 0 0 .759.35h7.08a1 1 0 0 0 1-1V3a1 1 0 0 0-1-1h-7.08z" />
            </svg>
        </button>
        <a href="javascript:;" class="">
            <img class="mx-auto d-block w-25 img-fluid avatar avatar-s rounded-circle" alt="Image placeholder"
                src="https://demos.creative-tim.com/argon-dashboard-pro/assets/img/theme/team-4.jpg"
                style="width: 100px;">

        </a>
        <h3 class="text-center" id="user-name_avatar">avatar</h3>
        <div id="progress">
            <a href="progressList.html" class="btn btn-info w-25 text-center m-auto">Progress</a>
            <br>
            <a>1. last thing they did</a>
            <br>
            <a>2. the one before that</a>
            <br>
            <a>3. and finaly the last</a>
        </div>
    </div>

    <div id="friend">
        <div id="fT">Friend List</div>
        <div id="f1">
            <img alt="Image placeholder"
                src="https://demos.creative-tim.com/argon-dashboard-pro/assets/img/theme/team-4.jpg"
                style="width: 15%; border-radius: 100%;">
            <div class="progress" style="width: 80%;">
                <div class="progress-bar" role="progressbar" style="width: 25%;" aria-valuenow="25" aria-valuemin="0"
                    aria-valuemax="100"></div>
            </div>
        </div>
        <div id="f2">
            <img alt="Image placeholder"
                src="https://demos.creative-tim.com/argon-dashboard-pro/assets/img/theme/team-4.jpg"
                style="width: 15%; border-radius: 100%;">
            <div class="progress" style="width: 80%;">
                <div class="progress-bar" role="progressbar" style="width: 25%;" aria-valuenow="25" aria-valuemin="0"
                    aria-valuemax="100"></div>
            </div>
        </div>
        <div id="f3">
            <img alt="Image placeholder"
                src="https://demos.creative-tim.com/argon-dashboard-pro/assets/img/theme/team-4.jpg"
                style="width: 15%; border-radius: 100%;">
            <div class="progress" style="width: 80%; text-align: right;">
                <div class="progress-bar" role="progressbar" style="width: 25%;" aria-valuenow="25" aria-valuemin="0"
                    aria-valuemax="100"></div>
            </div>
        </div>

    </div>

    <div id="pref">
        <br>
        <br>
        <br>
        <h2 class="fs-4 text-center">Preferences</h2>
        <br>
        <div class="btn-group pref_set1" role="group" aria-label="Basic radio toggle button group" style="">
            <input type="radio" class="btn-check" name="btnradioS1" id="btnradio1" autocomplete="off" checked>
            <label class="btn btn-outline-primary" for="btnradio1">Anywhere</label>

            <input type="radio" class="btn-check" name="btnradioS1" id="btnradio2" autocomplete="off">
            <label class="btn btn-outline-warning" for="btnradio2">Indoor</label>

            <input type="radio" class="btn-check" name="btnradioS1" id="btnradio3" autocomplete="off">
            <label class="btn btn-outline-success" for="btnradio3">Outdoor</label>
        </div>
        <br>
        <br>
        <div class="btn-group pref_set2" role="group" aria-label="Basic radio toggle button group" style="">
            <input type="radio" class="btn-check" name="btnradioS2" id="btnradio4" autocomplete="off" checked>
            <label class="btn btn-outline-primary" for="btnradio4">Both</label>

            <input type="radio" class="btn-check" name="btnradioS2" id="btnradio5" autocomplete="off">
            <label class="btn btn-outline-warning" for="btnradio5">Physical</label>

            <input type="radio" class="btn-check" name="btnradioS2" id="btnradio6" autocomplete="off">
            <label class="btn btn-outline-success" for="btnradio6">Mental</label>
        </div>
        <br>
        <br>
        <div class="btn-group pref_set3" role="group" aria-label="Basic radio toggle button group" style="">
            <input type="radio" class="btn-check" name="btnradioS3" id="btnradio7" autocomplete="off" checked>
            <label class="btn btn-outline-primary" for="btnradio7">Under 5 min</label>

            <input type="radio" class="btn-check" name="btnradioS3" id="btnradio8" autocomplete="off">
            <label class="btn btn-outline-warning" for="btnradio8">Under 15 min</label>

            <input type="radio" class="btn-check" name="btnradioS3" id="btnradio9" autocomplete="off">
            <label class="btn btn-outline-danger" for="btnradio9">Under 30 min</label>
        </div>
    </div>

    <script src="../scripts/our_scripts/profile.js"></script>
    <script src="../scripts/universal_functions/backPage.js"></script>
    <script src="../scripts/universal_functions/fetchTipsMain.js"></script>
    <script src="../scripts/universal_functions/removeItem.js"></script>


    <script>
        const prefList = document.getElementById('pref');
        let preferencesToUpdate = ['Anywhere', 'Both', 'Under 5 min'];
        var user_Name;
        var user_Email
// let currentUser = db.collection("users").doc(user.uid);
        function insertName() {
            firebase.auth().onAuthStateChanged(user => {
                // Check if user is signed in:
                if (user) {
                    // Do something for the current logged-in user here: 
                    console.log(user.uid);
                    user_ID = user.uid;
                    //go to the correct user document by referencing to the user uid
                    currentUser = db.collection("users").doc(user.uid);
                    //get the document for current user.
                    currentUser.get()
                        .then(userDoc => {
                            user_Name = userDoc.data().name;
                            user_Email = userDoc.data().email;
                            console.log(user_Name);
                            //method #1:  insert with html only
                            document.getElementById("user-name_avatar").innerText = user_Name;
                                //using javascript
                        })
                } else {
                    console.log("you did not sign in");
                    // No user is signed in.
                }
                // return [user_Name, user_Email];
            });
        }
        insertName();

const fetchPrefText = (e) => {
  console.log(e);
  if (e.target.tagName == "LABEL") {
    const parent = e.target.parentNode;
      const preferenceToAdd = e.target.innerText;
      if (parent.classList.contains('pref_set1')) {
        preferencesToUpdate[0] = preferenceToAdd;
      }
      if (parent.classList.contains('pref_set2')) {
        preferencesToUpdate[1] = preferenceToAdd;
      }
      if (parent.classList.contains('pref_set3')) {
        preferencesToUpdate[2] = preferenceToAdd;
      } 
      savePreference();
    //   console.log(preferencesToUpdate);
    }
}

function savePreference() {
  currentUser.get()
    .then(userDoc => {
      console.log(userDoc.data());
    })
    if (user_Name && user_Email) {
        currentUser.update({
                  name: user_Name,
                  email: user_Email,
                  personalPref: preferencesToUpdate
              })
              .then(() => {
                  console.log("Document successfully updated!");
              })
    }
}



        var user_ID;
        
        prefList.addEventListener('click',fetchPrefText);
        
    </script>
    <!--------------------------------------------------------------------->
    <!-- JS files: Your own JavaScript functions included here    -->
    <!--------------------------------------------------------------------->
</body>

</html>