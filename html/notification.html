<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Homepage</title>
    <meta name="comp1800 boilerplate code" content="my bcit project" />
    <meta name="author" content="BCIT" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />

    <!-- Bootstrap, firebase-auth-ui -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-BmbxuPwQa2lc/FVzBcNJ7UAyJxM6wuqIj61tLrc4wSX0szH/Ev+nYRRuWlolflfl" crossorigin="anonymous">
    <link type="text/css" rel="stylesheet" href="https://www.gstatic.com/firebasejs/ui/4.8.1/firebase-ui-auth.css" />

    <!-- Firebase 8 CDNs-->
    <!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script> -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/ui/4.8.1/firebase-ui-auth.js"></script>


    <!-- Link to the api keys for your firebase project -->
    <script src="../scripts/firebaseAPI.js"></script>

    <!-- Optional styles -->
    <link type="text/css" href="styles/my_style.css" rel="stylesheet">
    <link class="logo" href="/images/DAILY_DOSE.png" rel="icon" type="image/x-icon"/>

</head>

<body>
    <button id="backButton">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-arrow-left"
            viewbox="0 0 16 16">
            <path fill-rule="evenodd"
                d="M15 8a.5.5 0 0 0-.5-.5H2.707l3.147-3.146a.5.5 0 1 0-.708-.708l-4 4a.5.5 0 0 0 0 .708l4 4a.5.5 0 0 0 .708-.708L2.707 8.5H14.5A.5.5 0 0 0 15 8z" />
        </svg>
    </button>
    <div class="mt-5 container">
        <div class="mt-5 container w-70">
            <h2 class="fs-4 text-center">Notification</h2>
            <br>
            <br>
            <br>
            <fieldset class="mb-3" id="personalInfoFields" disabled>
                <ul class="list-group w-100">

                    <li class="list-group-item justify-content-between">
                        <input type="checkbox" value="">
                        <label style="font-weight: bold;">pop-up notification</label>
                        <br>
                        <input type="checkbox" value="">
                        <label>Vibrate</label>
                        <br>
                        <input type="checkbox" value="">
                        <label>Silent</label>
                    </li>

                </ul>
                <br><br>
                <ul class="list-group w-100">
                    <li class="list-group-item justify-content-between">
                        <input type="checkbox" value="">
                        <label style="font-weight: bold;">Email</label>
                        <br>
                        <input id="emailInput" type="text" placeholder="ahhh.boo@my.bcit.ca"><br>
                    </li>

                </ul>
                <br><br>
                <ul class="list-group w-100">
                    <li class="list-group-item justify-content-between">
                        <input type="checkbox" value="">
                        <label style="font-weight: bold;">SMS</label>
                        <br>
                        <input id="phoneInput" type="text" placeholder="250-420-6969"><br>
                    </li>

                </ul>
            </fieldset>
            <button onclick="editUserInfo()">Edit</button>
            <button type="button" class="btn btn-info" onclick="saveUserInfo()">Save</button>
        </div>
    </div>

    <script src="../scripts/universal_functions/backPage.js"></script>
    <script>
        var currentUser;
    
        function populateInfo() {
            firebase.auth().onAuthStateChanged(user => {
                // Check if user is signed in:
                if (user) {
                currentUser = db.collection("users").doc(user.uid)

                currentUser.get()
                    .then(userDoc => {
                        var userPhone = userDoc.data().phone;
                        var userEmail = userDoc.data().email;

                        if (userPhone != null) {
                            document.getElementById("phoneInput").value = userPhone;
                        }
                        if (userEmail != null) {
                            document.getElementById("emailInput").value = userEmail;
                        }
                    })
            } else {
                // No user is signed in.
                console.log("No user is signed in");
            }
        })
    }
    populateInfo();

        function editUserInfo() {
            //Enable the form fields
            document.getElementById('personalInfoFields').disabled = false;
        }
        
        function saveUserInfo() {
    userPhone = document.getElementById('phoneInput').value;       
    //get the value of the field with id="nameInput"
    userEmail = document.getElementById('emailInput').value;

    currentUser.update({
                    email: userEmail,
                    phone: userPhone,
                })
                .then(() => {
                    console.log("Document successfully updated!");
                })
                
    document.getElementById('personalInfoFields').disabled = true;
}

    </script>
</body>

</html>